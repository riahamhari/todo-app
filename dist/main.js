(()=>{"use strict";function e(e){localStorage.setItem("taskList",JSON.stringify(e))}function t(){return JSON.parse(localStorage.getItem("taskList"))}function n(e){localStorage.setItem("projectList",JSON.stringify(e))}function c(){document.querySelector("#taskListSection").innerHTML="";let e=document.getElementsByClassName("active")[0].innerText;for(let t=0;t<i(`${e}`).length;t++)f(i(`${e}`)[t])}function a(){const e=document.querySelectorAll(".sidebar-item");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(function(){let e=document.getElementsByClassName("active");e[0].className=e[0].className.replace(" active",""),this.className+=" active"}))}const o=()=>{document.querySelector("#taskListSection").innerHTML=""},r=e=>{document.querySelector("#projectTitle").innerText=e},i=e=>t().length<=0?S.filter((t=>t.projectSelected===e)):t().filter((t=>t.projectSelected===e));let s=[];const l=()=>{const e={name:document.querySelector("#newProjectInput").value,tasks:[],taskNum:S.length};s.push(e),n(s),u(e),d(e)};function d(t){const c=document.querySelector("#projectGroup"),l=document.createElement("li");l.classList.add("list-group-item","border-0","sidebar-item","project-item"),l.innerHTML=`<div><i class="fa-regular fa-circle"></i>${t.name}</div><i id="deleteProject"\n    class="fa-solid fa-trash-can"></i>`,l.addEventListener("click",(()=>{r(`${t.name}`),o(),a();for(let e=0;e<i(`${t.name}`).length;e++)f(i(`${t.name}`)[e])})),l.querySelector("#deleteProject").addEventListener("click",(t=>{t.stopPropagation();const a=t.target.parentNode.innerText;console.log(a),c.innerHTML="",function(t){(function(e){const t=document.querySelector("#taskProject").options;for(let n=0;n<t.length;n++)t[n].text===e&&t.remove(n)})(t),s=[];const c=JSON.parse(localStorage.getItem("projectList")).filter((e=>e.name!==t));for(let e=0;e<c.length;e++)s.push(c[e]);localStorage.setItem("projectList","[]");const a=S.filter((e=>e.projectSelected!==t));c.forEach((e=>d(e))),e(a),n(c)}(a)}),{once:!0}),c.appendChild(l)}function u(e){const t=document.querySelector("#taskProject"),n=document.createElement("option"),c=document.querySelector("#editedTaskProject");n.setAttribute("value",`${e.name}`),n.innerText=e.name,t.appendChild(n),c.appendChild(n)}let m,p=0,S=[];function f(t){p++;const n=document.querySelector("#taskListSection"),c=document.createElement("li");c.classList.add("list-group-item","taskItem"),c.setAttribute("id",`task${p}`);const a=document.createElement("div");a.classList.add("taskName");const o=document.createElement("input");o.classList.add("form-check-input","me-1"),o.setAttribute("type","checkbox"),o.setAttribute("id",`todo${p}`);const r=document.createElement("label");r.classList.add("form-check-label"),r.setAttribute("data-bs-toggle","collapse"),r.setAttribute("data-bs-target",`#collapseDetails${p}`),r.setAttribute("aria-expanded","false"),r.setAttribute("aria-controls",`collapseDetails${p}`),r.setAttribute("type","button"),r.textContent=` ${t.name}`;const i=document.createElement("div");i.classList.add("taskAction"),document.createElement("div").classList.add("card"),document.createElement("div").classList.add("card-body");const s=document.createElement("div");s.classList.add("collapse"),s.setAttribute("id",`collapseDetails${p}`);const l=document.createElement("div");l.classList.add("card","card-body");const d=document.createElement("span");d.classList.add("list-group-item"),d.innerHTML=`<b>Due Date:</b> ${t.date} ${t.time}`;const u=document.createElement("span");u.classList.add("list-group-item"),u.innerHTML=`<b>Description:</b> ${t.description}`;const b=document.createElement("span");b.classList.add("list-group-item"),b.innerHTML=`<b>Priority:</b> ${t.priority}`;const k=document.createElement("i");k.classList.add("fa-regular","fa-pen-to-square","tt"),k.setAttribute("data-bs-placement","bottom"),k.setAttribute("title","edit"),k.setAttribute("type","button"),k.setAttribute("data-bs-toggle","modal"),k.setAttribute("data-bs-target","#updateTodoModal"),k.setAttribute("data-task-id",t.taskId),k.addEventListener("click",(e=>{const t=e.target.dataset.taskId,n=S.findIndex((e=>e.taskId===parseInt(t)));m=S[n],function(e){const t=document.querySelector("#editedTaskNameInput"),n=document.querySelector("#editedTaskDescription"),c=document.querySelector("#editedTaskDueDate"),a=document.querySelector("#editedTodoTime"),o=document.querySelector("#editedTaskPriority"),r=document.querySelector("#editedTaskProject");t.value=e.name,n.value=e.description,c.value=e.date,a.value=e.time,o.value=e.priority,r.value=e.projectSelected}(S[n])}));const v=document.createElement("i");v.classList.add("fa-solid","fa-flag","tt"),v.setAttribute("data-bs-placement","bottom"),v.setAttribute("title","Change Priority");const g=document.createElement("i");g.classList.add("fa-solid","fa-circle-arrow-right","tt"),g.setAttribute("data-bs-placement","bottom"),g.setAttribute("title","Move To Project");const L=document.createElement("i");L.classList.add("fa-regular","fa-trash-can","tt"),L.setAttribute("data-bs-placement","bottom"),L.setAttribute("data-task-id",t.taskId),L.addEventListener("click",(t=>{const c=t.target.dataset.taskId;console.log(c);const a=S.findIndex((e=>e.taskId===parseInt(c)));n.innerHTML="",function(t){console.log(t);let n=JSON.parse(localStorage.getItem("taskList"));n.splice(t,1),S.splice(t,1),e(n),n.forEach((e=>f(e))),function(){document.querySelector("#taskListSection").innerHTML="";let e=document.getElementsByClassName("active")[0].innerText;for(let t=0;t<y(`${e}`).length;t++)f(y(`${e}`)[t])}()}(a)})),L.setAttribute("title","Delete"),a.append(o,r),i.append(k,v,g,L),c.append(a,i),n.appendChild(c),l.append(d,u,b),s.appendChild(l),n.appendChild(s)}S=t();const y=e=>t().length<=0?S.filter((t=>t.projectSelected===e)):t().filter((t=>t.projectSelected===e));(function(){const e=document.querySelectorAll(".sidebar-item");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(function(){let e=document.getElementsByClassName("active");e[0].className=e[0].className.replace(" active",""),this.className+=" active"}))})(),window.addEventListener("load",(()=>{for(let e=0;e<i("Inbox").length;e++)f(i("Inbox")[e]);JSON.parse(localStorage.getItem("projectList")).forEach((e=>{d(e),u(e)}))})),document.querySelector("#saveBtn").addEventListener("click",(function(){!function(){const t=document.querySelector("#editedTaskNameInput").value,n=document.querySelector("#editedTaskDescription").value,c=document.querySelector("#editedTaskDueDate").value,a=document.querySelector("#editedTodoTime").value,o=document.querySelector("#editedTaskPriority").value,r=document.querySelector("#editedTaskProject").value,i=S.findIndex((e=>e.taskId===m.taskId));S[i].name=t,S[i].description=n,S[i].date=c,S[i].time=a,S[i].priority=o,S[i].projectSelected=r,e(S)}(),c(),$("#updateTodoModal").modal("hide")})),document.querySelector("#submitTaskBtn").addEventListener("click",(function(){!function(){const e=(t=document.querySelector("#taskNameInput").value,n=document.querySelector("#taskDescription").value,c=document.querySelector("#taskDueDate").value,a=document.querySelector("#todoTime").value,o=document.querySelector("#taskPriority").value,r=document.querySelector("#taskProject").value,p++,{name:t,description:n,date:c,time:a,priority:o,projectSelected:r,taskId:p});var t,n,c,a,o,r;S.push(e),f(e)}(),e(S),document.querySelector("#taskNameInput").value="",document.querySelector("#taskDescription").value="",document.querySelector("#taskDueDate").value="",document.querySelector("#todoTime").value="",c()})),document.querySelector("#submitProjectBtn").addEventListener("click",(function(){l(),document.querySelector("#newProjectInput").value="",document.querySelectorAll(".project-item").forEach((e=>e.addEventListener("click",(()=>{r(e.innerText),o();for(let t=0;t<i(e.innerText).length;t++)f(i(e.innerText)[t])})))),a()})),document.querySelectorAll(".sidebar-item").forEach((e=>e.addEventListener("click",(()=>{r(e.innerText),o(),a();for(let t=0;t<i(`${e.innerText}`).length;t++)f(i(`${e.innerText}`)[t])})))),document.querySelector("#inbox").addEventListener("click",(()=>{r("Inbox"),o(),a();for(let e=0;e<i("Inbox").length;e++)f(i("Inbox")[e])}))})();